"use strict";(self["webpackChunkrice"]=self["webpackChunkrice"]||[]).push([[874],{60874:function(t,e,s){s.r(e),s.d(e,{default:function(){return g}});var a=function(){var t=this,e=t._self._c;return e("div",{staticClass:"Cmain"},[e("div",{staticClass:"contents"},[e("div",{staticClass:"head"},[e("a-dropdown",[e("a-menu",{attrs:{slot:"overlay"},on:{click:t.handleMenuClick},slot:"overlay"},[e("a-menu-item",{key:"1"},[e("a-icon",{attrs:{type:"user"}}),t._v("1st menu item ")],1),e("a-menu-item",{key:"2"},[e("a-icon",{attrs:{type:"user"}}),t._v("2nd menu item ")],1),e("a-menu-item",{key:"3"},[e("a-icon",{attrs:{type:"user"}}),t._v("3rd item ")],1)],1),e("a-button",{staticStyle:{"margin-left":"8px"}},[t._v(" 角色状态 "),e("a-icon",{attrs:{type:"down"}})],1)],1),e("a-input-search",{staticStyle:{width:"500px","margin-left":"10px"},attrs:{placeholder:"请输入想要搜索的名称"},on:{input:function(e){return t.onSearch(t.Searchs)}},model:{value:t.Searchs,callback:function(e){t.Searchs=e},expression:"Searchs"}}),e("a-button",{attrs:{type:"primary"},on:{click:t.addshow}},[e("a-icon",{attrs:{type:"plus"}}),t._v("添加系统角色 ")],1)],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.addshows,expression:"addshows"}],staticClass:"tianjia"},[e("div",[e("h2",[t._v(t._s(t.caozuo)+"系统角色")]),e("a-button",{attrs:{type:"link"},on:{click:t.addshow}},[e("a-icon",{attrs:{type:"close"}})],1)],1),e("div",[t._v(" 角色名称： "),e("a-input",{attrs:{placeholder:"请输入名称"},model:{value:t.name,callback:function(e){t.name=e},expression:"name"}}),e("br"),e("br"),t._v(" 描述: "),e("a-textarea",{attrs:{placeholder:"请输入该描述","auto-size":""},model:{value:t.desc,callback:function(e){t.desc=e},expression:"desc"}}),e("br"),e("br"),t._v(" 状态: "),e("a-radio-group",{attrs:{name:"radioGroup","default-value":1},model:{value:t.status,callback:function(e){t.status=e},expression:"status"}},[e("a-radio",{attrs:{value:1}},[t._v(" 启用 ")]),e("a-radio",{attrs:{value:0}},[t._v(" 停用 ")])],1),e("br"),e("br"),e("div",[e("span",[t._v("管理权限:")]),e("div",[e("a-checkbox-group",{on:{change:t.onChange}},[e("a-row",[e("a-col",{attrs:{span:12}},[e("a-checkbox",{attrs:{value:"1"}},[t._v(" 主页 ")])],1),e("a-col",{attrs:{span:12}},[e("a-checkbox",{attrs:{value:"2"}},[t._v(" 企业管理 ")])],1),e("a-col",{attrs:{span:12}},[e("a-checkbox",{attrs:{value:"3"}},[t._v(" 角色管理 ")])],1)],1)],1)],1)]),e("br"),e("a-button",{attrs:{type:"primary",block:""},on:{click:t.listadd}},[t._v(" 提交 ")]),e("span",{staticStyle:{display:"block",color:"red",margin:"auto"}},[t._v(t._s(t.error))])],1)]),e("div",{staticClass:"center"},[e("el-table",{staticStyle:{width:"100%"},attrs:{data:t.tableData}},[e("el-table-column",{attrs:{label:"姓名",width:"180"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},[e("el-tag",{attrs:{size:"medium"}},[t._v(t._s(s.row.rolename))])],1)]}}])}),e("el-table-column",{attrs:{label:"描述",width:"180"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(s.row.describe))])]}}])}),e("el-table-column",{attrs:{label:"角色权限配置",width:"220"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{staticStyle:{"margin-left":"10px"}},[t._v(t._s(t.converquanxian(s.row.powers)))])]}}])}),e("el-table-column",{attrs:{label:"角色启用状态",width:"180"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("span",{staticStyle:{"margin-left":"10px"}},[e("i",{class:1==s.row.status?"i_greey":"i_red"}),t._v(t._s(t.converstatus(s.row.status)))])]}}])}),e("el-table-column",{attrs:{label:"最后编辑时间",width:"180"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("i",{staticClass:"el-icon-time"},[t._v(t._s(t.formatTimestamp(s.row.lasttime)))]),e("span",{staticStyle:{"margin-left":"10px"}})]}}])}),e("el-table-column",{attrs:{label:"操作"},scopedSlots:t._u([{key:"default",fn:function(s){return[e("el-button",{attrs:{type:"primary",icon:"el-icon-edit",circle:""},on:{click:function(e){return t.handleEdit(s.row)}}}),e("el-button",{attrs:{type:"danger",icon:"el-icon-delete",circle:""},on:{click:function(e){return t.handleDelete(s.row)}}}),e("el-button",{ref:"button",attrs:{type:1==s.row.status?"danger":"info",icon:1==s.row.status?"el-icon-switch-button":"el-icon-video-play",circle:""},on:{click:function(e){return t.start(s.row)}}})]}}])})],1)],1),e("div",{staticClass:"footer"},[e("el-pagination",{attrs:{background:"",layout:"prev, pager, next",total:t.total,"current-page":t.pagecount},on:{"update:currentPage":function(e){t.pagecount=e},"update:current-page":function(e){t.pagecount=e},"current-change":t.pagefy}})],1)])])},n=[],o=s(40412);function r(t){return new Promise((e=>{(0,o.V)("/index.php/index/role/getroleslist",{page:t}).then((t=>{e(t)}))}))}function i(t){return new Promise((e=>{(0,o.V)("/index.php/index/role/addroles",t).then((t=>{e(t)}))}))}function l(t){return new Promise((e=>{(0,o.V)("/index.php/index/role/uproles",t).then((t=>{e(t)}))}))}function c(t){return new Promise((e=>{(0,o.V)("/index.php/index/role/delroles?id="+t).then((t=>{e(t)}))}))}function u(t,e){return new Promise((s=>{(0,o.V)(`/index.php/index/role/stoproles?id=${t}&&status=${e}`).then((t=>{s(t)}))}))}function d(t){return new Promise((e=>{(0,o.V)(`/index.php/index/role/getsearchroles?rolename=${t}`).then((t=>{e(t)}))}))}var h={data(){return{id:"",caozuo:"",tableData:[],addshows:!1,name:"",desc:"",status:"",powers:"",error:"",total:0,page:0,pagecount:1,Searchs:""}},created(){this.Listshow()},methods:{pagefy(){this.Listshow(this.pagecount)},listadd(){null==this.id||""==this.id?i({rolename:this.name,describe:this.desc,powers:this.powers,status:this.status}).then((t=>{console.log(t),0==t.code?(this.Listshow(),this.addshows=!1,this.name="",this.desc="",this.status="",this.powers=""):this.error=t.msg})):l({id:this.id,rolename:this.name,describe:this.desc,powers:this.powers,status:this.status}).then((t=>{console.log(t),0==t.code?(this.Listshow(),this.addshows=!1,this.name="",this.desc="",this.status="",this.powers=""):this.error=t.msg}))},addshow(){this.caozuo="添加",1==this.addshows?(this.addshows=!1,this.name="",this.desc="",this.status="",this.powers=""):0==this.addshows&&(this.addshows=!0)},onChange(t){this.powers=t.toString(),console.log(this.powers)},formatTimestamp(t){const e=1e3*t,s=new Date(e),a=`${s.getFullYear()}-${s.getMonth()+1}-${s.getDate()} ${s.getHours()}:${s.getMinutes()}:${s.getSeconds()}`;return a},Listshow(t){r(t).then((t=>{console.log(t),this.tableData=t.data.data,this.total=t.data.pagecount}))},handleEdit(t){console.log(t),this.id=t.id,this.caozuo="修改",this.name=t.rolename,this.desc=t.describe,this.status=t.status,this.powers=t.powers,1==this.addshows?(this.addshows=!1,this.name="",this.desc="",this.status="",this.powers="",this.error=""):0==this.addshows&&(this.addshows=!0)},handleDelete(t){this.$confirm({title:"确定要删除这项任务吗？",content:"这将永久删除该任务。",okText:"确定",okType:"danger",cancelText:"取消",onOk:()=>{c(t.id).then((t=>{console.log(t),this.Listshow()})),console.log("OK")},onCancel(){console.log("Cancel")}})},start(t){1==t.status?this.$confirm({title:"确定要停用这项任务吗？",content:"这将停用该任务。",okText:"确定",okType:"danger",cancelText:"取消",onOk:()=>{u(t.id,0).then((t=>{console.log(t,"停用"),this.Listshow()})),console.log("OK")},onCancel(){console.log("Cancel")}}):0==t.status&&this.$confirm({title:"确定要启用这项任务吗？",content:"这将启用该任务。",okText:"确定",okType:"danger",cancelText:"取消",onOk:()=>{u(t.id,1).then((t=>{console.log(t,"启用"),this.Listshow()})),console.log("OK")},onCancel(){console.log("Cancel")}})},converstatus(t){return 0===t?"停用":"启用"},converquanxian(t){const e=t.split(","),s=e.map((t=>{switch(t.trim()){case"1":return"主页";case"2":return"企业管理";case"3":return"角色管理";default:return""}})).filter((t=>t));return s.length?s.join("，"):"无效的权限标识"},handleButtonClick(t){console.log("click left button",t)},handleMenuClick(t){console.log("click",t)},onSearch(t){console.log(t),d(t).then((t=>{console.log(t),this.tableData=t.data.data,this.total=t.data.pagecount}))}}},p=h,m=s(81656),w=(0,m.A)(p,a,n,!1,null,"ca42b454",null),g=w.exports},40412:function(t,e,s){s.d(e,{$:function(){return o},V:function(){return n}});var a=s(98355);function n(t,e){return new Promise(((s,n)=>{a.A.get(t,{params:e,headers:{token:sessionStorage.getItem("token")}}).then((t=>{s(t.data)})).catch((t=>{n(t.data)}))}))}function o(t,e){return new Promise(((s,n)=>{(0,a.A)({method:"post",url:t,data:e}).then((t=>{s(t.data)})).catch((t=>{n(t.data)}))}))}a.A.defaults.baseURL="https://www.zzgoodqc.cn/",console.log("正式"),a.A.interceptors.response.use((function(t){return t}),(function(t){return Promise.reject(t)}))}}]);
//# sourceMappingURL=874.be3183ac.js.map